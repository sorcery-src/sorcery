@use "sass:list";
@use "sass:map";

@use "helpers" as *;

@use "core/background-color" as *;
@use "core/border-color" as *;
@use "core/border-radius" as *;
@use "core/border-width" as *;
@use "core/box-shadow" as *;
@use "core/color" as *;
@use "core/font-family" as *;
@use "core/font-size" as *;
@use "core/font-style" as *;
@use "core/font-weight" as *;
@use "core/grid" as *;
@use "core/letter-spacing" as *;
@use "core/line-height" as *;
@use "core/margin" as *;
@use "core/max-width" as *;
@use "core/min-height" as *;
@use "core/min-width" as *;
@use "core/opacity" as *;
@use "core/overflow" as *;
@use "core/padding" as *;
@use "core/pointer-events" as *;
@use "core/position" as *;
@use "core/text-align" as *;
@use "core/text-decoration" as *;
@use "core/transform" as *;
@use "core/transition" as *;
@use "core/vertical-align" as *;
@use "core/white-space" as *;
@use "core/z-index" as *;

@use "extensions/aspect-ratio" as *;
@use "extensions/container" as *;
@use "extensions/group" as *;
@use "extensions/hidden" as *;
@use "extensions/stacks" as *;

@use "configuration";
@use "utils";

// NOTE: Dart Sass does not support dynamic mixin invocations.
// Therefore mixins are conditionally, statically invoked.
//
// https://github.com/sass/sass/issues/626
//
// prettier-ignore
@mixin call-mixin($mixin, $variants...) {
	@if $mixin == "aspect-ratio" { @include aspect-ratio($variants...); }
	@if $mixin == "background-color" { @include background-color($variants...); }
	@if $mixin == "border-color" { @include border-color($variants...); }
	@if $mixin == "border-radius" { @include border-radius($variants...); }
	@if $mixin == "border-width" { @include border-width($variants...); }
	@if $mixin == "box-shadow" { @include box-shadow($variants...); }
	@if $mixin == "color" { @include color($variants...); }
	@if $mixin == "container" { @include container($variants...); }
	@if $mixin == "font-family" { @include font-family($variants...); }
	@if $mixin == "font-size" { @include font-size($variants...); }
	@if $mixin == "font-style" { @include font-style($variants...); }
	@if $mixin == "font-weight" { @include font-weight($variants...); }
	@if $mixin == "grid" { @include grid($variants...); }
	@if $mixin == "group" { @include group($variants...); }
	@if $mixin == "hidden" { @include hidden($variants...); }
	@if $mixin == "letter-spacing" { @include letter-spacing($variants...); }
	@if $mixin == "line-height" { @include line-height($variants...); }
	@if $mixin == "margin" { @include margin($variants...); }
	@if $mixin == "max-width" { @include max-width($variants...); }
	@if $mixin == "min-height" { @include min-height($variants...); }
	@if $mixin == "min-width" { @include min-width($variants...); }
	@if $mixin == "opacity" { @include opacity($variants...); }
	@if $mixin == "overflow" { @include overflow($variants...); }
	@if $mixin == "padding" { @include padding($variants...); }
	@if $mixin == "pointer-events" { @include pointer-events($variants...); }
	@if $mixin == "position" { @include position($variants...); }
	@if $mixin == "stacks" { @include stacks($variants...); }
	@if $mixin == "text-align" { @include text-align($variants...); }
	@if $mixin == "text-decoration" { @include text-decoration($variants...); }
	@if $mixin == "transform" { @include transform($variants...); }
	@if $mixin == "transition" { @include transition($variants...); }
	@if $mixin == "vertical-align" { @include vertical-align($variants...); }
	@if $mixin == "white-space" { @include white-space($variants...); }
	@if $mixin == "z-index" { @include z-index($variants...); }
}

@mixin duomo {
	$hidden: map.get(configuration.$variants, hidden);
	$non-hidden: utils.take(configuration.$variants, hidden);

	// Non-responsive:
	@each $mk, $mv in $non-hidden {
		@include call-mixin($mk, utils.take($mv, responsive)...);
	}
	@include call-mixin(hidden, utils.take($hidden, responsive)...);

	// Responsive:
	@each $key, $px in breakpoints() {
		@media (min-width: px($px)) {
			.#{delimit($key)} {
				@at-root {
					@each $property, $variants in $non-hidden {
						@if list.index($variants, responsive) {
							@include call-mixin($property, responsive);
						}
					}
					@if list.index($hidden, responsive) {
						@include call-mixin(hidden, responsive);
					}
				}
			}
		}
	}
}
